/*!
 * VERSION: 0.5.0
 * DATE: 2015-09-24
 * GIT:https://github.com/shrekshrek/csstween
 *
 * @author: Shrek.wang, shrekshrek@gmail.com
 **/

!function(t){var n="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"function"==typeof define&&define.amd?define(["exports"],function(e){n.CT=t(n,e)}):"undefined"!=typeof exports?t(n,exports):n.CT=t(n,{})}(function(t,n){function e(t,n){for(var e in n)t[e]=n[e]}function i(t,n){if(void 0===t.length)n.call(t,0,t);else for(var e=0;e<t.length;e++)n.call(t[e],e,t[e])}function r(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function a(t){return t.replace(/\b(\w)|\s(\w)/g,function(t){return t.toUpperCase()})}function o(t){var n=[];for(var e in t)n[e]=t[e];return n}function s(){var t=document.createElement("div"),n=["Webkit","Moz","Ms","O"];for(var e in n)if(n[e]+"Animation"in t.style){H=n[e],"Moz"!==H&&(U=H.toLowerCase()+"AnimationStart",K=H.toLowerCase()+"AnimationIteration",Y=H.toLowerCase()+"AnimationEnd");break}}function u(t){return t?H+a(t):H}function l(){return++B}function f(){var t=document.createElement("style");t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t),M=t.sheet,F=M.cssRules||M.rules||[]}function h(t){for(var n in F){var e=F[n];if(e.type===V&&e.name===t||e.type===z&&e.selectorText===t)return{rule:e,index:n}}return null}function c(t,n){var e=F.length;M.insertRule?M.insertRule(t+"{"+n+"}",e):M.addRule&&M.addRule(t,n,e)}function d(t){var n=h(t);null!==n&&(M.deleteRule?M.deleteRule(n.index):M.removeRule&&M.removeRule(n.index))}function m(t){var n="";for(var e in t)"key"!==e&&(n+=r(e)+":"+t[e]+";");return n}function v(t,n){var e="ct_kfs_"+t,i="",a=n.length;for(var o in n){var s;s=void 0!==n[o].key?n[o].key:Math.floor(o/(a-1)*100),i+=s+"%{"+m(n[o])+"}"}return c("@"+r(u("Keyframes"))+" "+e,i),e}function g(t,n){var e="ct_anim_"+t,i=r(u("Animation"))+":"+n+";";return i+=r(u("AnimationFillMode"))+":both;",c("."+e,i),e}function p(t){var n="ct_pause_"+t,e=r(u("AnimationPlayState"))+":paused;";return c("."+n,e),n}function y(t,n){return!!t.className.match(new RegExp("(\\s|^)"+n))}function _(t,n){y(t,n)||(t.className+=" "+n)}function E(t,n){t.className=t.className.replace(new RegExp("(\\s|^)"+n),"")}function S(t){if(!t)throw"target is undefined, can't tween!!!";return"string"==typeof t?"undefined"==typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t):t}function w(t,n){return void 0!==t.style[n]?n:(n=u(n),void 0!==t.style[n]?n:null)}function I(t,n){if("string"==typeof n){var e=n.substr(0,2),i=parseFloat(n.substr(2));switch(e){case"+=":n=parseFloat(t)+i;break;case"-=":n=parseFloat(t)-i}}return n}function R(t,n){for(var e in W)if(t===W[e])return n;return"number"==typeof n?n+"px":n}function b(t,n){if(document.defaultView&&document.defaultView.getComputedStyle){var e=r(n),i=document.defaultView.getComputedStyle(t,"");return i&&i.getPropertyValue(e)}return t.currentStyle?t.currentStyle[n]:null}function C(t,n){for(var e in n)t.style[e]=n[e]}function N(){return++j}function k(){this.init.apply(this,arguments)}function A(){this.onStart&&this.onStart.apply(this.target,this.onStartParams)}function L(){this.onIteration&&this.onIteration.apply(this.target,this.onIterationParams)}function T(){this.kill(!0)}function P(t,n,e){var i=function(){e.call()};return t.addEventListener(n,i,!1),i}function x(t,n,e){t.removeEventListener(n,e,!1)}var O=t.CT;n.VERSION="0.5.0",n.noConflict=function(){return t.CT=O,this};var M,F,H="",U="animationstart",K="animationiteration",Y="animationend",V=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE,z=window.CSSRule.STYLE_RULE||window.CSSRule.WEBKIT_STYLE_RULE||window.CSSRule.MOZ_STYLE_RULE,B=0,W=["fontWeight","lineHeight","opacity","zoom"],Z={},j=0;return e(k.prototype,{init:function(){var t=arguments,e=t[3],i=e.length,r=e[i-1];this.var0=t[2],this.target=t[0],this.duration=t[1],this.ease="cubic-bezier"+(r.ease||n.Linear.None),this.repeat=r.repeat||1,this.yoyo=r.yoyo||!1,this.delay=r.delay||0,this.onStart=r.onStart||null,this.onStartParams=r.onStartParams||[],this.onIteration=r.onIteration||null,this.onIterationParams=r.onIterationParams||[],this.onEnd=r.onEnd||null,this.onEndParams=r.onEndParams||[],this.isPlaying=r.isPlaying||!0;var a=N();this.target._ct_tId&&Z[this.target._ct_tId].kill(),this.target._ct_tId=a,this.vars=[];var o,s,u;for(s in e){o={};for(u in this.var0)"key"===u?o[u]=e[s][u]:o[w(this.target,u)]=R(u,I(this.var0[u],e[s][u]));this.vars.push(o)}var f=l();this.kfsName=v(f,this.vars),this.animName=g(f,this.kfsName+" "+this.duration+"s "+this.ease+" "+this.delay+"s "+(this.repeat<0?"infinite":this.repeat)+" "+(this.yoyo?"alternate":"normal")),this.pauseName=p(f),this.startHandler=P(this.target,U,A.bind(this)),this.iterationHandler=P(this.target,K,L.bind(this)),this.endHandler=P(this.target,Y,T.bind(this)),_(this.target,this.animName),this.isPlaying||this.pause(),Z[a]=this},play:function(){E(this.target,this.pauseName)},pause:function(){_(this.target,this.pauseName)},kill:function(t){this.pause(),this.play();var n=this.vars[this.vars.length-1];if(t)C(this.target,n);else for(var e in n)this.target.style[e]=b(this.target,e);x(this.target,U,this.startHandler),x(this.target,K,this.iterationHandler),x(this.target,Y,this.endHandler),E(this.target,this.animName),d(this.kfsName),d("."+this.animName),d("."+this.pauseName),delete Z[this.target._ct_tId],delete this.target._ct_tId,t&&this.onEnd&&this.onEnd.apply(this.target,this.onEndParams)}}),e(n,{get:function(t,n){var e=S(t);void 0!==e.length&&(e=e[0]);var i=w(e,n);return i?b(e,i):null},set:function(t,n){var e=S(t);i(e,function(t,e){var i={};for(var r in n){var a=w(e,r);a&&(i[a]=R(a,I(b(e,a),n[r])))}C(e,i)})},fromTo:function(){if(arguments.length<4)throw"The number of parameters is not enough!";var t=o(arguments),n=S(t[0]),e=[],r=t[2];return i(n,function(n,i){var a={};for(var o in r){var s=w(i,o);s&&(a[o]=b(i,s))}var u=new k(i,t[1],a,t.slice(2));e.push(u)}),1==e.length?e[0]:e},from:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=o(arguments),n=t.length,e=S(t[0]),r=[],a=t[2];return i(e,function(e,i){var o={},s={};for(var u in a){var l=w(i,u);l&&(s[u]=o[u]=b(i,l))}var f=t[n-1];for(var h in f)void 0==s[h]&&(s[h]=f[h]);var c=new k(i,t[1],o,t.slice(2).concat(s));r.push(c)}),1==r.length?r[0]:r},to:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=o(arguments),n=S(t[0]),e=[],r=t[2];return i(n,function(n,i){var a={};for(var o in r){var s=w(i,o);s&&(a[o]=b(i,s))}var u=new k(i,t[1],a,[a].concat(t.slice(2)));e.push(u)}),1==e.length?e[0]:e},kill:function(t,n){var e=S(t);i(e,function(t,e){e._ct_tId&&Z[e._ct_tId].kill(n)})},killAll:function(t){for(var n in Z)Z[n].kill(t)},pause:function(t){var n=S(t);i(n,function(t,n){n._ct_tId&&Z[n._ct_tId].pause()})},pauseAll:function(){for(var t in Z)Z[t].pause()},play:function(t){var n=S(t);i(n,function(t,n){n._ct_tId&&Z[n._ct_tId].play()})},playAll:function(){for(var t in Z)Z[t].play()}}),e(n,{Linear:{None:"(0, 0, 1, 1)"},Sine:{In:"(0.35, 0, 1, 1)",Out:"(0, 0, 0.65, 1)",InOut:"(0.35, 0, 0.65, 1)"},Quad:{In:"(0.45, 0, 1, 1)",Out:"(0, 0, 0.55, 1)",InOut:"(0.45, 0, 0.55, 1)"},Quart:{In:"(0.75, 0, 1, 1)",Out:"(0, 0, 0.25, 1)",InOut:"(0.75, 0, 0.25, 1)"},Expo:{In:"(1, 0, 1, 1)",Out:"(0, 0, 0, 1)",InOut:"(1, 0, 0, 1)"}}),s(),f(),n});
