/*!
 * VERSION: 0.5.0
 * DATE: 2015-09-24
 * GIT:https://github.com/shrekshrek/csstween
 *
 * @author: Shrek.wang, shrekshrek@gmail.com
 **/

!function(t){var e="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"function"==typeof define&&define.amd?define(["exports"],function(n){e.CT=t(e,n)}):"undefined"!=typeof exports?t(e,exports):e.CT=t(e,{})}(function(t,e){function n(t,e){for(var n in e)t[n]=e[n]}function a(t,e){if(void 0===t.length)e.call(t,0,t);else for(var n=0;n<t.length;n++)e.call(t[n],n,t[n])}function i(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function r(t){return t.replace(/\b(\w)|\s(\w)/g,function(t){return t.toUpperCase()})}function o(t){var e=[];for(var n in t)e[n]=t[n];return e}function s(){var t=document.createElement("div"),e=["Webkit","Moz","Ms","O"];for(var n in e)if(e[n]+"Animation"in t.style){H=e[n],"Moz"!==H&&(U=H.toLowerCase()+"AnimationStart",z=H.toLowerCase()+"AnimationIteration",K=H.toLowerCase()+"AnimationEnd");break}}function u(t){return t?H+r(t):H}function l(){var t=document.createElement("style");t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t),M=t.sheet,F=M.cssRules||M.rules||[]}function f(){return++B}function h(t){for(var e in F){var n=F[e];if(n.type===Y&&n.name===t||n.type===V&&n.selectorText===t)return{rule:n,index:e}}return null}function c(t,e){var n=F.length;M.insertRule?M.insertRule(t+"{"+e+"}",n):M.addRule&&M.addRule(t,e,n)}function d(t){var e=h(t);null!==e&&(M.deleteRule?M.deleteRule(e.index):M.removeRule&&M.removeRule(e.index))}function m(t){var e="";for(var n in t)"key"!==n&&(e+=i(n)+":"+t[n]+";");return e}function p(t,e){var n="ct_kfs_"+t,a="",r=e.length;for(var o in e){var s;s=void 0!==e[o].key?e[o].key:Math.floor(o/(r-1)*100),a+=s+"%{"+m(e[o])+"}"}return c("@"+i(u("Keyframes"))+" "+n,a),n}function v(t,e){var n="ct_anim_"+t,a=i(u("Animation"))+":"+e+";";return a+=i(u("AnimationFillMode"))+":both;",c("."+n,a),n}function g(t){var e="ct_pause_"+t,n=i(u("AnimationPlayState"))+":paused;";return c("."+e,n),e}function y(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e))}function _(t,e){y(t,e)||(t.className+=" "+e)}function E(t,e){t.className=t.className.replace(new RegExp("(\\s|^)"+e),"")}function S(t){if(!t)throw"target is undefined, can't tween!!!";return"string"==typeof t?"undefined"==typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t):t}function R(t,e){return void 0!==t.style[e]?e:(e=u(e),void 0!==t.style[e]?e:null)}function w(t,e){if("string"==typeof e){var n=e.substr(0,2),a=parseFloat(e.substr(2));switch(n){case"+=":e=parseFloat(t)+a;break;case"-=":e=parseFloat(t)-a}}return e}function b(t,e){for(var n in W)if(t===W[n])return e;return"number"==typeof e?e+"px":e}function I(t,e){if(document.defaultView&&document.defaultView.getComputedStyle){var n=i(e),a=document.defaultView.getComputedStyle(t,"");return a&&a.getPropertyValue(n)}return t.currentStyle?t.currentStyle[e]:null}function C(t,e){for(var n in e)t.style[n]=e[n]}function N(){return++j}function k(){this.initialize.apply(this,arguments)}function A(){this.onStart&&this.onStart.apply(this.target,this.onStartParams)}function L(){this.onRepeat&&this.onRepeat.apply(this.target,this.onRepeatParams)}function T(){this.kill(!0)}function P(t,e,n){var a=function(){n.call()};return t.addEventListener(e,a,!1),a}function x(t,e,n){t.removeEventListener(e,n,!1)}var O=t.CT;e.VERSION="0.5.0",e.noConflict=function(){return t.CT=O,this};var M,F,H="",U="animationstart",z="animationiteration",K="animationend",Y=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE,V=window.CSSRule.STYLE_RULE||window.CSSRule.WEBKIT_STYLE_RULE||window.CSSRule.MOZ_STYLE_RULE,B=0,W=["fontWeight","lineHeight","opacity","zoom"],Z={},j=0;return n(k.prototype,{initialize:function(){var t=arguments,n=t[3],a=n.length,i=n[a-1];this.var0=t[2],this.target=t[0],this.duration=t[1],this.ease="cubic-bezier"+(i.ease||e.Linear.None),this.repeat=i.repeat||1,this.yoyo=i.yoyo||!1,this.delay=i.delay||0,this.onStart=i.onStart||null,this.onStartParams=i.onStartParams||[],this.onRepeat=i.onRepeat||null,this.onRepeatParams=i.onRepeatParams||[],this.onEnd=i.onEnd||null,this.onEndParams=i.onEndParams||[],this.isPlaying=i.isPlaying||!0;var r=N();this.target._ct_tId&&Z[this.target._ct_tId].kill(),this.target._ct_tId=r,this.vars=[];var o,s,u;for(s in n){o={};for(u in this.var0)"key"===u?o[u]=n[s][u]:o[R(this.target,u)]=b(u,w(this.var0[u],n[s][u]));this.vars.push(o)}var l=f();this.kfsName=p(l,this.vars),this.animName=v(l,this.kfsName+" "+this.duration+"s "+this.ease+" "+this.delay+"s "+(this.repeat<0?"infinite":this.repeat)+" "+(this.yoyo?"alternate":"normal")),this.pauseName=g(l),this.startHandler=P(this.target,U,A.bind(this)),this.repeatHandler=P(this.target,z,L.bind(this)),this.endHandler=P(this.target,K,T.bind(this)),_(this.target,this.animName),this.isPlaying||this.pause(),Z[r]=this},play:function(){E(this.target,this.pauseName)},pause:function(){_(this.target,this.pauseName)},kill:function(t){this.pause(),this.play();var e=this.vars[this.vars.length-1];if(t)C(this.target,e);else for(var n in e)this.target.style[n]=I(this.target,n);x(this.target,U,this.startHandler),x(this.target,z,this.repeatHandler),x(this.target,K,this.endHandler),E(this.target,this.animName),d(this.kfsName),d("."+this.animName),d("."+this.pauseName),delete Z[this.target._ct_tId],delete this.target._ct_tId,t&&this.onEnd&&this.onEnd.apply(this.target,this.onEndParams)}}),n(e,{get:function(t,e){var n=S(t);void 0!==n.length&&(n=n[0]);var a=R(n,e);return a?I(n,a):null},set:function(t,e){var n=S(t);a(n,function(t,n){var a={};for(var i in e){var r=R(n,i);r&&(a[r]=b(r,w(I(n,r),e[i])))}C(n,a)})},fromTo:function(){if(arguments.length<4)throw"The number of parameters is not enough!";var t=o(arguments),e=S(t[0]),n=[],i=t[2];return a(e,function(e,a){var r={};for(var o in i){var s=R(a,o);s&&(r[o]=I(a,s))}var u=new k(a,t[1],r,t.slice(2));n.push(u)}),1==n.length?n[0]:n},from:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=o(arguments),e=t.length,n=S(t[0]),i=[],r=t[2];return a(n,function(n,a){var o={},s={};for(var u in r){var l=R(a,u);l&&(s[u]=o[u]=I(a,l))}var f=t[e-1];for(var h in f)void 0==s[h]&&(s[h]=f[h]);var c=new k(a,t[1],o,t.slice(2).concat(s));i.push(c)}),1==i.length?i[0]:i},to:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=o(arguments),e=S(t[0]),n=[],i=t[2];return a(e,function(e,a){var r={};for(var o in i){var s=R(a,o);s&&(r[o]=I(a,s))}var u=new k(a,t[1],r,[r].concat(t.slice(2)));n.push(u)}),1==n.length?n[0]:n},kill:function(t,e){var n=S(t);a(n,function(t,n){n._ct_tId&&Z[n._ct_tId].kill(e)})},killAll:function(t){for(var e in Z)Z[e].kill(t)},pause:function(t){var e=S(t);a(e,function(t,e){e._ct_tId&&Z[e._ct_tId].pause()})},pauseAll:function(){for(var t in Z)Z[t].pause()},play:function(t){var e=S(t);a(e,function(t,e){e._ct_tId&&Z[e._ct_tId].play()})},playAll:function(){for(var t in Z)Z[t].play()}}),n(e,{Linear:{None:"(0, 0, 1, 1)"},Sine:{In:"(0.35, 0, 1, 1)",Out:"(0, 0, 0.65, 1)",InOut:"(0.35, 0, 0.65, 1)"},Quad:{In:"(0.45, 0, 1, 1)",Out:"(0, 0, 0.55, 1)",InOut:"(0.45, 0, 0.55, 1)"},Quart:{In:"(0.75, 0, 1, 1)",Out:"(0, 0, 0.25, 1)",InOut:"(0.75, 0, 0.25, 1)"},Expo:{In:"(1, 0, 1, 1)",Out:"(0, 0, 0, 1)",InOut:"(1, 0, 0, 1)"}}),s(),l(),e});
