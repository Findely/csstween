/*!
 * VERSION: 0.5.0
 * DATE: 2015-09-24
 * GIT:https://github.com/shrekshrek/csstween
 *
 * @author: Shrek.wang, shrekshrek@gmail.com
 **/

!function(t){var e="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"function"==typeof define&&define.amd?define(["exports"],function(n){e.CT=t(e,n)}):"undefined"!=typeof exports?t(e,exports):e.CT=t(e,{})}(function(t,e){function n(t,e){for(var n in e)t[n]=e[n]}function a(t,e){if(void 0===t.length)e.call(t,0,t);else for(var n=0;n<t.length;n++)e.call(t[n],n,t[n])}function i(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function r(t){return t.replace(/\b(\w)|\s(\w)/g,function(t){return t.toUpperCase()})}function s(t){var e=[];for(var n in t)e[n]=t[n];return e}function o(t){return t?x+r(t):x}function u(){return++Y}function l(t){for(var e in U){var n=U[e];if(n.type===z&&n.name===t||n.type===K&&n.selectorText===t)return{rule:n,index:e}}return null}function c(t,e){var n=U.length;H.insertRule?H.insertRule(t+"{"+e+"}",n):H.addRule&&H.addRule(t,e,n)}function f(t){var e=l(t);null!==e&&(H.deleteRule?H.deleteRule(e.index):H.removeRule&&H.removeRule(e.index))}function h(t){var e="";for(var n in t)"key"!==n&&(e+=i(n)+":"+t[n]+";");return e}function d(t,e){var n="ct_kfs_"+t,a="",r=e.length;for(var s in e){var u;u=void 0!==e[s].key?e[s].key:Math.floor(s/(r-1)*100),a+=u+"%{"+h(e[s])+"}"}return c("@"+i(o("Keyframes"))+" "+n,a),n}function m(t,e){var n="ct_anim_"+t,a=i(o("Animation"))+":"+e+";";return a+=i(o("AnimationFillMode"))+":both;",c("."+n,a),n}function v(t){var e="ct_pause_"+t,n=i(o("AnimationPlayState"))+":paused;";return c("."+e,n),e}function p(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e))}function g(t,e){p(t,e)||(t.className+=" "+e)}function y(t,e){t.className=t.className.replace(new RegExp("(\\s|^)"+e),"")}function _(t){if(!t)throw"target is undefined, can't tween!!!";return"string"==typeof t?"undefined"==typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t):t}function E(t,e){return void 0!==t.style[e]?e:(e=o(e),void 0!==t.style[e]?e:null)}function R(t,e){if("string"==typeof e){var n=e.substr(0,2),a=parseFloat(e.substr(2));switch(n){case"+=":e=parseFloat(t)+a;break;case"-=":e=parseFloat(t)-a}}return e}function S(t,e){switch(t){case"opacity":case"fontWeight":case"lineHeight":case"zoom":return e;default:return"number"==typeof e?e+"px":e}}function w(t,e){if(document.defaultView&&document.defaultView.getComputedStyle){var n=i(e),a=document.defaultView.getComputedStyle(t,"");return a&&a.getPropertyValue(n)}return t.currentStyle?t.currentStyle[e]:null}function b(t,e){for(var n in e)t.style[n]=e[n]}function I(){return++V}function k(){this.initialize.apply(this,arguments)}function C(){this.onStart&&this.onStart.apply(this,this.onStartParams)}function N(){this.onRepeat&&this.onRepeat.apply(this,this.onRepeatParams)}function A(){this.kill(!0)}function L(t,e,n){var a=function(){n.call()};return t.addEventListener(e,a,!1),a}function T(t,e,n){t.removeEventListener(e,n,!1)}var P=t.CT;e.VERSION="0.5.0",e.noConflict=function(){return t.CT=P,this};var x="",M="animationstart",O="animationiteration",F="animationend";!function(){var t=document.createElement("div"),e=["Webkit","Moz","Ms","O"];for(var n in e)if(e[n]+"Animation"in t.style){x=e[n],"Moz"!==x&&(M=x.toLowerCase()+"AnimationStart",O=x.toLowerCase()+"AnimationIteration",F=x.toLowerCase()+"AnimationEnd");break}}();var H,U,z=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE,K=window.CSSRule.STYLE_RULE||window.CSSRule.WEBKIT_STYLE_RULE||window.CSSRule.MOZ_STYLE_RULE,Y=0;!function(){var t=document.createElement("style");t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t),H=t.sheet,U=H.cssRules||H.rules||[]}();var B={},V=0;return n(k.prototype,{initialize:function(){var t=arguments,n=t[3],a=n.length,i=n[a-1];this.var0=t[2],this.target=t[0],this.duration=t[1],this.ease="cubic-bezier"+(i.ease||e.Linear.None),this.repeat=i.repeat||1,this.yoyo=i.yoyo||!1,this.delay=i.delay||0,this.onStart=i.onStart||null,this.onStartParams=i.onStartParams||[],this.onRepeat=i.onRepeat||null,this.onRepeatParams=i.onRepeatParams||[],this.onEnd=i.onEnd||null,this.onEndParams=i.onEndParams||[],this.isPlaying=i.isPlaying||!0;var r=I();this.target._ct_tId&&B[this.target._ct_tId].kill(),this.target._ct_tId=r,this.vars=[];var s,o,l;for(o in n){s={};for(l in this.var0)"key"===l?s[l]=n[o][l]:s[E(this.target,l)]=S(l,R(this.var0[l],n[o][l]));this.vars.push(s)}var c=u();this.kfsName=d(c,this.vars),this.animName=m(c,this.kfsName+" "+this.duration+"s "+this.ease+" "+this.delay+"s "+(this.repeat<0?"infinite":this.repeat)+" "+(this.yoyo?"alternate":"normal")),this.pauseName=v(c),this.startHandler=L(this.target,M,C.bind(this)),this.repeatHandler=L(this.target,O,N.bind(this)),this.endHandler=L(this.target,F,A.bind(this)),g(this.target,this.animName),this.isPlaying||this.pause(),B[r]=this},play:function(){y(this.target,this.pauseName)},pause:function(){g(this.target,this.pauseName)},kill:function(t){this.pause(),this.play();var e=this.vars[this.vars.length-1];if(t)b(this.target,e);else for(var n in e)this.target.style[n]=w(this.target,n);T(this.target,M,this.startHandler),T(this.target,O,this.repeatHandler),T(this.target,F,this.endHandler),y(this.target,this.animName),f(this.kfsName),f("."+this.animName),f("."+this.pauseName),delete B[this.target._ct_tId],delete this.target._ct_tId,t&&this.onEnd&&this.onEnd.apply(this,this.onEndParams)}}),n(e,{get:function(t,e){var n=_(t);void 0!==n.length&&(n=n[0]);var a=E(n,e);return a?w(n,a):null},set:function(t,e){var n=_(t);a(n,function(t,n){var a={};for(var i in e){var r=E(n,i);r&&(a[r]=S(r,R(w(n,r),e[i])))}b(n,a)})},fromTo:function(){if(arguments.length<4)throw"The number of parameters is not enough!";var t=s(arguments),e=_(t[0]),n=[],i=t[2];return a(e,function(e,a){var r={};for(var s in i){var o=E(a,s);o&&(r[s]=w(a,o))}var u=new k(a,t[1],r,t.slice(2));n.push(u)}),1==n.length?n[0]:n},from:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=s(arguments),e=t.length,n=_(t[0]),i=[],r=t[2];return a(n,function(n,a){var s={},o={};for(var u in r){var l=E(a,u);l&&(o[u]=s[u]=w(a,l))}var c=t[e-1];for(var f in c)void 0==o[f]&&(o[f]=c[f]);var h=new k(a,t[1],s,t.slice(2).concat(o));i.push(h)}),1==i.length?i[0]:i},to:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=s(arguments),e=_(t[0]),n=[],i=t[2];return a(e,function(e,a){var r={};for(var s in i){var o=E(a,s);o&&(r[s]=w(a,o))}var u=new k(a,t[1],r,[r].concat(t.slice(2)));n.push(u)}),1==n.length?n[0]:n},kill:function(t,e){var n=_(t);a(n,function(t,n){n._ct_tId&&B[n._ct_tId].kill(e)})},killAll:function(t){for(var e in B)B[e].kill(t)},pause:function(t){var e=_(t);a(e,function(t,e){e._ct_tId&&B[e._ct_tId].pause()})},pauseAll:function(){for(var t in B)B[t].pause()},play:function(t){var e=_(t);a(e,function(t,e){e._ct_tId&&B[e._ct_tId].play()})},playAll:function(){for(var t in B)B[t].play()}}),n(e,{Linear:{None:"(0, 0, 1, 1)"},Quad:{In:"(0.3, 0, 0.65, 0.75)",Out:"(0.35, 0.25, 0.7, 1)",InOut:"(0.46, 0.03, 0.54, 0.97)"},Quart:{In:"(0.5, 0, 0.75, 0)",Out:"(0.25, 1, 0.5, 1)",InOut:"(0.75, 0, 0.25, 1)"},Back:{In:"(0, 0.35, 0.7, -0.6)",Out:"(0.3, 1.6, 0.65, 1)",InOut:"(0.5, -0.5, 0.5, 1.5)"}}),e});
