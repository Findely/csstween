/*!
 * VERSION: 0.5.0
 * DATE: 2015-09-24
 * GIT:https://github.com/shrekshrek/csstween
 *
 * @author: Shrek.wang, shrekshrek@gmail.com
 **/

!function(t){var e="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"function"==typeof define&&define.amd?define(["exports"],function(n){e.CT=t(e,n)}):"undefined"!=typeof exports?t(e,exports):e.CT=t(e,{})}(function(t,e){function n(t,e){for(var n in e)t[n]=e[n]}function i(t,e){if(void 0===t.length)e.call(t,0,t);else for(var n=0;n<t.length;n++)e.call(t[n],n,t[n])}function r(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function a(t){return t.replace(/\b(\w)|\s(\w)/g,function(t){return t.toUpperCase()})}function o(t){var e=[];for(var n in t)e[n]=t[n];return e}function s(){var t=document.createElement("div"),e=["Webkit","Moz","Ms","O"];for(var n in e)if(e[n]+"Animation"in t.style){H=e[n],"Moz"!==H&&(U=H.toLowerCase()+"AnimationStart",K=H.toLowerCase()+"AnimationIteration",Y=H.toLowerCase()+"AnimationEnd");break}}function u(t){return t?H+a(t):H}function l(){return++B}function f(){var t=document.createElement("style");t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t),M=t.sheet,F=M.cssRules||M.rules||[]}function c(t){for(var e in F){var n=F[e];if(n.type===V&&n.name===t||n.type===z&&n.selectorText===t)return{rule:n,index:e}}return null}function h(t,e){var n=F.length;M.insertRule?M.insertRule(t+"{"+e+"}",n):M.addRule&&M.addRule(t,e,n)}function d(t){var e=c(t);null!==e&&(M.deleteRule?M.deleteRule(e.index):M.removeRule&&M.removeRule(e.index))}function m(t){var e="";for(var n in t)"key"!==n&&(e+=r(n)+":"+t[n]+";");return e}function v(t,e){var n="ct_kfs_"+t,i="",a=e.length;for(var o in e){var s;s=void 0!==e[o].key?e[o].key:Math.floor(o/(a-1)*100),i+=s+"%{"+m(e[o])+"}"}return h("@"+r(u("Keyframes"))+" "+n,i),n}function g(t,e){var n="ct_anim_"+t,i=r(u("Animation"))+":"+e+";";return i+=r(u("AnimationFillMode"))+":both;",h("."+n,i),n}function p(t){var e="ct_pause_"+t,n=r(u("AnimationPlayState"))+":paused;";return h("."+e,n),e}function y(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e))}function _(t,e){y(t,e)||(t.className+=" "+e)}function w(t,e){t.className=t.className.replace(new RegExp("(\\s|^)"+e),"")}function E(t){if(!t)throw"target is undefined, can't tween!!!";switch(typeof t){case"string":return"undefined"==typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t);case"object":return t;default:throw"target is undefined, can't tween!!!"}}function S(t,e){return void 0!==t.style[e]?e:(e=u(e),void 0!==t.style[e]?e:null)}function I(t,e){if("string"==typeof e){var n=e.substr(0,2),i=parseFloat(e.substr(2));switch(n){case"+=":e=parseFloat(t)+i;break;case"-=":e=parseFloat(t)-i}}return e}function R(t,e){for(var n in W)if(t===W[n])return e;return"number"==typeof e?e+"px":e}function b(t,e){if(document.defaultView&&document.defaultView.getComputedStyle){var n=r(e),i=document.defaultView.getComputedStyle(t,"");return i&&i.getPropertyValue(n)}return t.currentStyle?t.currentStyle[e]:null}function C(t,e){for(var n in e)t.style[n]=e[n]}function N(){return++Z}function k(){this.init.apply(this,arguments)}function A(){this.onStart&&this.onStart.apply(this.target,this.onStartParams)}function L(){this.onIteration&&this.onIteration.apply(this.target,this.onIterationParams)}function T(){this.kill(!0)}function P(t,e,n){var i=function(){n.call()};return t.addEventListener(e,i,!1),i}function x(t,e,n){t.removeEventListener(e,n,!1)}var O=t.CT;e.VERSION="0.5.0",e.noConflict=function(){return t.CT=O,this};var M,F,H="",U="animationstart",K="animationiteration",Y="animationend",V=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE,z=window.CSSRule.STYLE_RULE||window.CSSRule.WEBKIT_STYLE_RULE||window.CSSRule.MOZ_STYLE_RULE,B=0,W=["fontWeight","lineHeight","opacity","zoom"],j={},Z=0;return n(k.prototype,{init:function(){var t=arguments,n=t[3],i=n.length,r=n[i-1];this.var0=t[2],this.target=t[0],this.duration=t[1],this.ease="cubic-bezier"+(r.ease||e.Linear.None),this.repeat=r.repeat||1,this.yoyo=r.yoyo||!1,this.delay=r.delay||0,this.onStart=r.onStart||null,this.onStartParams=r.onStartParams||[],this.onIteration=r.onIteration||null,this.onIterationParams=r.onIterationParams||[],this.onEnd=r.onEnd||null,this.onEndParams=r.onEndParams||[],this.isPlaying=r.isPlaying||!0;var a=N();this.target._ct_tId&&j[this.target._ct_tId].kill(),this.target._ct_tId=a,this.vars=[];var o,s,u;for(s in n){o={};for(u in this.var0)"key"===u?o[u]=n[s][u]:o[S(this.target,u)]=R(u,I(this.var0[u],n[s][u]));this.vars.push(o)}var f=l();this.kfsName=v(f,this.vars),this.animName=g(f,this.kfsName+" "+this.duration+"s "+this.ease+" "+this.delay+"s "+(this.repeat<0?"infinite":this.repeat)+" "+(this.yoyo?"alternate":"normal")),this.pauseName=p(f),this.startHandler=P(this.target,U,A.bind(this)),this.iterationHandler=P(this.target,K,L.bind(this)),this.endHandler=P(this.target,Y,T.bind(this)),_(this.target,this.animName),this.isPlaying||this.pause(),j[a]=this},play:function(){w(this.target,this.pauseName)},pause:function(){_(this.target,this.pauseName)},kill:function(t){this.pause();var e=this.vars[this.vars.length-1];if(t)C(this.target,e);else for(var n in e)this.target.style[n]=b(this.target,n);x(this.target,U,this.startHandler),x(this.target,K,this.iterationHandler),x(this.target,Y,this.endHandler),w(this.target,this.animName),d(this.kfsName),d("."+this.animName),d("."+this.pauseName),delete j[this.target._ct_tId],delete this.target._ct_tId,t&&this.onEnd&&this.onEnd.apply(this.target,this.onEndParams)}}),n(e,{get:function(t,e){var n=E(t);void 0!==n.length&&(n=n[0]);var i=S(n,e);return i?b(n,i):null},set:function(t,e){var n=E(t);i(n,function(t,n){var i={};for(var r in e){var a=S(n,r);a&&(i[a]=R(a,I(b(n,a),e[r])))}C(n,i)})},fromTo:function(){if(arguments.length<4)throw"The number of parameters is not enough!";var t=o(arguments),e=E(t[0]),n=[],r=t[2];return i(e,function(e,i){var a={};for(var o in r){var s=S(i,o);s&&(a[o]=b(i,s))}var u=new k(i,t[1],a,t.slice(2));n.push(u)}),1==n.length?n[0]:n},from:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=o(arguments),e=t.length,n=E(t[0]),r=[],a=t[2];return i(n,function(n,i){var o={},s={};for(var u in a){var l=S(i,u);l&&(s[u]=o[u]=b(i,l))}var f=t[e-1];for(var c in f)void 0==s[c]&&(s[c]=f[c]);var h=new k(i,t[1],o,t.slice(2).concat(s));r.push(h)}),1==r.length?r[0]:r},to:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var t=o(arguments),e=E(t[0]),n=[],r=t[2];return i(e,function(e,i){var a={};for(var o in r){var s=S(i,o);s&&(a[o]=b(i,s))}var u=new k(i,t[1],a,[a].concat(t.slice(2)));n.push(u)}),1==n.length?n[0]:n},kill:function(t,e){var n=E(t);i(n,function(t,n){n._ct_tId&&j[n._ct_tId].kill(e)})},killAll:function(t){for(var e in j)j[e].kill(t)},pause:function(t){var e=E(t);i(e,function(t,e){e._ct_tId&&j[e._ct_tId].pause()})},pauseAll:function(){for(var t in j)j[t].pause()},play:function(t){var e=E(t);i(e,function(t,e){e._ct_tId&&j[e._ct_tId].play()})},playAll:function(){for(var t in j)j[t].play()}}),n(e,{Linear:{None:"(0, 0, 1, 1)"},Sine:{In:"(0.35, 0, 1, 1)",Out:"(0, 0, 0.65, 1)",InOut:"(0.35, 0, 0.65, 1)"},Quad:{In:"(0.45, 0, 1, 1)",Out:"(0, 0, 0.55, 1)",InOut:"(0.45, 0, 0.55, 1)"},Quart:{In:"(0.75, 0, 1, 1)",Out:"(0, 0, 0.25, 1)",InOut:"(0.75, 0, 0.25, 1)"},Expo:{In:"(1, 0, 1, 1)",Out:"(0, 0, 0, 1)",InOut:"(1, 0, 0, 1)"}}),s(),f(),e});
