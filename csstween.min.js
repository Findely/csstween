/*!
 * VERSION: 0.4.0
 * DATE: 2015-05-19
 * GIT:https://github.com/shrekshrek/csstween
 *
 * @author: Shrek.wang, shrekshrek@gmail.com
 **/

!function(e){var n="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;"function"==typeof define&&define.amd?define(["exports"],function(t){n.CT=e(n,t)}):"undefined"!=typeof exports?e(n,exports):n.CT=e(n,{})}(function(e,n){function t(e,n){for(var t in n)e[t]=n[t]}function r(e,n){if(void 0===e.length)n.call(e,0,e);else for(var t=0;t<e.length;t++)n.call(e[t],t,e[t])}function a(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function o(e){return e.replace(/\b(\w)|\s(\w)/g,function(e){return e.toUpperCase()})}function i(e){var n=[];for(var t in e)n[t]=e[t];return n}function u(){if(void 0!==Y)return Y;var e=document.createElement("div"),n=["","Webkit","Moz","O"];for(var t in n)if(n[t]+"Animation"in e.style)return Y=!0,B=n[t],""!==B&&"Moz"!==B&&(W=B.toLowerCase()+"Animationstart",j=B.toLowerCase()+"Animationiteration",Z=B.toLowerCase()+"AnimationEnd"),s(),!0;return!1}function c(e){return e?B+o(e):B}function s(){var e=document.createElement("style");e.rel="stylesheet",e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),z=e.sheet,P=z.cssRules||z.rules||[]}function l(e){for(var n in P){var t=P[n];if(t.type===q&&t.name===e||t.type===Q&&t.selectorText===e)return{rule:t,index:n}}return null}function f(e,n){var t=P.length;z.insertRule?z.insertRule(e+"{"+n+"}",t):z.addRule&&z.addRule(e,n,t)}function m(e){var n=l(e);null!==n&&(z.deleteRule?z.deleteRule(n.index):z.removeRule&&z.removeRule(n.index))}function d(e){var n="";for(var t in e)"key"!==t&&(n+=a(t)+":"+e[t]+";");return n}function v(e,n){var t="ct_kfs_"+e,r="",o=n.length;for(var i in n){var u;u=void 0!==n[i].key?n[i].key:Math.floor(i/(o-1)*100),r+=u+"%{"+d(n[i])+"}"}return f("@"+a(c("Keyframes"))+" "+t,r),t}function p(e,n){var t="ct_anim_"+e,r=a(c("Animation"))+":"+n+";";return r+=a(c("AnimationFillMode"))+":both;",f("."+t,r),t}function h(e){var n="ct_pause_"+e,t=a(c("AnimationPlayState"))+":paused;";return f("."+n,t),n}function g(e,n){return!!e.className.match(new RegExp("(\\s|^)"+n))}function b(e,n){g(e,n)||(e.className+=" "+n)}function y(e,n){e.className=e.className.replace(new RegExp("(\\s|^)"+n),"")}function w(){return"ct_tween_"+ ++D}function _(e,n){e._ct_tId&&R(e._ct_tId),e._ct_tId=n}function E(e,n){e._ct_tId===n&&delete e._ct_tId}function k(e){if(!Y&&!u())throw"this browser does not support css animation!!!";if(!e)throw"dom is undefined, can't tween!!!";switch(typeof e){case"string":return"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e);case"object":return e;default:throw"dom is undefined, can't tween!!!"}}function S(){if("number"!=typeof arguments[1])throw"Second param need a number!!!";var e=arguments[0],n=w();_(e,n);for(var t=arguments.length,r=[],a=2;t-1>a;a++){var o={},i=arguments[a];for(var u in i)switch(u){case"key":o[u]=i[u];break;default:var c=I(e,u);c&&(o[c]=C(e,c,i[u]))}r.push(o)}var s,l,f,m,d,g,y=arguments[t-1],E={},k=arguments[1]+"s",S="cubic-bezier(0, 0, 1, 1)",R="0s",L=1,M="normal";for(var F in y)switch(F){case"ease":S="cubic-bezier"+y[F];break;case"repeat":L=-1===y[F]?"infinite":y[F];break;case"yoyo":y[F]&&(M="alternate");break;case"delay":R=y[F]+"s";break;case"onStart":s=y[F];break;case"onStartParams":l=y[F];break;case"onIteration":f=y[F];break;case"onIterationParams":m=y[F];break;case"onEnd":d=y[F];break;case"onEndParams":g=y[F];break;case"key":E[F]=y[F];break;default:var c=I(e,F);c&&(E[c]=C(e,c,y[F]))}r.push(E);var o={},N=++H,U=v(N,r),K=p(N,U+" "+k+" "+S+" "+R+" "+L+" "+M),V=h(N);o.dom=e,o.keyframes=U,o.anim=K,o.pause=V,o.css=L%2===0?r[0]:E,o[W]=x(e,W,A,{callback:s,params:l}),o[j]=x(e,j,T,{callback:f,params:m}),o[Z]=x(e,Z,O,{callback:d,params:g,id:n}),b(e,K),$[n]=o}function R(e,n){var t=$[e];if(void 0===n&&(n=!1),U(t),K(t),M(t.dom,W,t[W].handler),M(t.dom,j,t[j].handler),M(t.dom,Z,t[Z].handler),n)N(t.dom,t.css),t[Z].params.callback&&t[Z].params.callback.apply(t.dom,t[Z].params.params);else for(var r in t.css)t.dom.style[r]=F(t.dom,r);y(t.dom,t.anim),m(t.keyframes),m("."+t.anim),m("."+t.pause),E(t.dom,e),delete $[e]}function I(e,n){var t=n;for(var r in G)t===G[r]&&(t=c(t));return void 0!==e.style[t]?t:null}function C(e,n,t){var r=L(e,n,t);for(var a in J)if(n===J[a])return r;return"number"==typeof r?r+"px":r}function L(e,n,t){if("string"==typeof t){var r=t.substr(0,2),a=parseFloat(t.substr(2));switch(r){case"+=":t=parseFloat(F(e,n))+a;break;case"-=":t=parseFloat(F(e,n))-a}}return t}function A(e){e.callback&&e.callback.apply(this,e.params)}function T(e){e.callback&&e.callback.apply(this,e.params)}function O(e){R(e.id,!0)}function x(e,n,t,r){var a=function(){t.apply(e,[r])};return e.addEventListener?e.addEventListener(n,a,!1):e.attachEvent?e.attachEvent("on"+n,a):e["on"+n]=a,{handler:a,params:r}}function M(e,n,t){e.removeEventListener?e.removeEventListener(n,t):e.detachEvent?e.detachEvent("on"+n,t):delete e["on"+n]}function F(e,n){var t=e,r=I(e,n);if(null===r)throw"css name is wrong!!!";if(document.defaultView&&document.defaultView.getComputedStyle){var o=a(r),i=document.defaultView.getComputedStyle(t,"");return i&&i.getPropertyValue(o)}return t.currentStyle?t.currentStyle[r]:null}function N(e,n){var t=e;for(var r in n)t.style[r]=n[r]}function U(e){var n=e;b(n.dom,n.pause)}function K(e){var n=e;y(n.dom,n.pause)}var V=e.CT;n.VERSION="0.4.0",n.noConflict=function(){return e.CT=V,this};var Y,z,P,B="",W="animationstart",j="animationiteration",Z="animationend",q=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE,Q=window.CSSRule.STYLE_RULE||window.CSSRule.WEBKIT_STYLE_RULE||window.CSSRule.MOZ_STYLE_RULE,H=0,$={},D=0,G=["transform","transformOrigin","transformStyle","perspective","perspectiveOrigin","backfaceVisibility","transition"],J=["fontWeight","lineHeight","opacity","zoom"];return t(n,{get:function(e,n){if(arguments.length>2)throw"The number of parameters is too much!";var t=k(e);return F(t[0],n)},set:function(e,n){if(arguments.length>2)throw"The number of parameters is too much!";var t=k(e);r(t,function(e,t){var r={};for(var a in n){var o=I(t,a);o&&(r[o]=C(t,o,n[a]))}N(t,r)})},fromTo:function(){if(arguments.length<4)throw"The number of parameters is not enough!";var e=arguments,n=k(e[0]);r(n,function(n,t){var r=i(e);r[0]=t,S.apply(this,r)})},from:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var e=arguments,n=k(e[0]);r(n,function(n,t){var r=e[e.length-1],a={};for(var o in r){var u=I(t,o);a[o]=u?F(t,o):r[o]}var c=i(e);c[0]=t,c.push(a),S.apply(this,c)})},to:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var e=arguments,n=k(e[0]);r(n,function(n,t){var r={},a=e[e.length-1];for(var o in a){var u=I(t,o);r[o]=u?F(t,o):a[o]}var c=i(e);c[0]=t,c.splice(2,0,r),S.apply(this,c)})},kill:function(e,n){var t=k(e);r(t,function(e,t){t._ct_tId&&R(t._ct_tId,n)})},killAll:function(e){for(var n in $)R(n,e)},pause:function(e){var n=k(e);r(n,function(e,n){n._ct_tId&&U($[n._ct_tId])})},pauseAll:function(){for(var e in $)U($[e])},play:function(e){var n=k(e);r(n,function(e,n){n._ct_tId&&K($[n._ct_tId])})},playAll:function(){for(var e in $)K($[e])}}),t(n,{Linear:{None:"(0, 0, 1, 1)"},Sine:{In:"(0.35, 0, 1, 1)",Out:"(0, 0, 0.65, 1)",InOut:"(0.35, 0, 0.65, 1)"},Quad:{In:"(0.45, 0, 1, 1)",Out:"(0, 0, 0.55, 1)",InOut:"(0.45, 0, 0.55, 1)"},Quart:{In:"(0.75, 0, 1, 1)",Out:"(0, 0, 0.25, 1)",InOut:"(0.75, 0, 0.25, 1)"},Expo:{In:"(1, 0, 1, 1)",Out:"(0, 0, 0, 1)",InOut:"(1, 0, 0, 1)"}}),n});
