/*!
 * VERSION: 0.4.0
 * DATE: 2015-05-19
 * GIT:https://github.com/shrekshrek/csstween
 *
 * @author: Shrek.wang, shrekshrek@gmail.com
 **/

!function(e,n){"function"==typeof define&&define.amd?define(["exports"],function(t){e.CT=e.CssTween=n(e,t)}):e.CT=e.CssTween=n(e,{})}(this,function(e,n){function t(e,n){for(var t in n)e[t]=n[t]}function a(e,n){if(void 0===e.length)n.call(e,0,e);else for(var t=0;t<e.length;t++)n.call(e[t],t,e[t])}function r(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function o(e){return e.replace(/\b(\w)|\s(\w)/g,function(e){return e.toUpperCase()})}function i(e){var n=[];for(var t in e)n[t]=e[t];return n}function u(){if(void 0!==Y)return Y;var e=document.createElement("div"),n=["","Webkit","Moz","O"];for(var t in n)if(n[t]+"Animation"in e.style)return Y=!0,B=n[t],""!==B&&"Moz"!==B&&(W=B.toLowerCase()+"Animationstart",Z=B.toLowerCase()+"Animationiteration",q=B.toLowerCase()+"AnimationEnd"),c(),!0;return!1}function s(e){return e?B+o(e):B}function c(){var e=document.createElement("style");e.rel="stylesheet",e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),z=e.sheet,P=z.cssRules||z.rules||[]}function l(e){for(var n in P){var t=P[n];if(t.type===Q&&t.name===e||t.type===j&&t.selectorText===e)return{rule:t,index:n}}return null}function f(e,n){var t=P.length;z.insertRule?z.insertRule(e+"{"+n+"}",t):z.addRule&&z.addRule(e,n,t)}function m(e){var n=l(e);null!==n&&(z.deleteRule?z.deleteRule(n.index):z.removeRule&&z.removeRule(n.index))}function d(e){var n="";for(var t in e)"key"!==t&&(n+=r(t)+":"+e[t]+";");return n}function v(e,n){var t="ct_kfs_"+e,a="",o=n.length;for(var i in n){var u;u=void 0!==n[i].key?n[i].key:Math.floor(i/(o-1)*100),a+=u+"%{"+d(n[i])+"}"}return f("@"+r(s("Keyframes"))+" "+t,a),t}function p(e,n){var t="ct_anim_"+e,a=r(s("Animation"))+":"+n+";";return a+=r(s("AnimationFillMode"))+":both;",f("."+t,a),t}function h(e){var n="ct_pause_"+e,t=r(s("AnimationPlayState"))+":paused;";return f("."+n,t),n}function g(e,n){return!!e.className.match(new RegExp("(\\s|^)"+n))}function y(e,n){g(e,n)||(e.className+=" "+n)}function b(e,n){e.className=e.className.replace(new RegExp("(\\s|^)"+n),"")}function w(){return"ct_tween_"+ ++D}function _(e,n){e._ct_tId&&I(e._ct_tId),e._ct_tId=n}function k(e,n){e._ct_tId===n&&delete e._ct_tId}function E(e){if(!Y&&!u())throw"this browser does not support css animation!!!";if(!e)throw"dom is undefined, can't tween!!!";switch(typeof e){case"string":return"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e);case"object":return e;default:throw"dom is undefined, can't tween!!!"}}function S(){if("number"!=typeof arguments[1])throw"Second param need a number!!!";var e=arguments[0],n=w();_(e,n);for(var t=arguments.length,a=[],r=2;t-1>r;r++){var o={},i=arguments[r];for(var u in i)switch(u){case"key":o[u]=i[u];break;default:var s=R(e,u);s&&(o[s]=C(e,s,i[u]))}a.push(o)}var c,l,f,m,d,g,b=arguments[t-1],k={},E=arguments[1]+"s",S="cubic-bezier(0, 0, 1, 1)",I="0s",T=1,M="normal";for(var F in b)switch(F){case"ease":S="cubic-bezier"+b[F];break;case"repeat":T=-1===b[F]?"infinite":b[F];break;case"yoyo":b[F]&&(M="alternate");break;case"delay":I=b[F]+"s";break;case"onStart":c=b[F];break;case"onStartParams":l=b[F];break;case"onIteration":f=b[F];break;case"onIterationParams":m=b[F];break;case"onEnd":d=b[F];break;case"onEndParams":g=b[F];break;case"key":k[F]=b[F];break;default:var s=R(e,F);s&&(k[s]=C(e,s,b[F]))}a.push(k);var o={},U=++H,K=v(U,a),N=p(U,K+" "+E+" "+S+" "+I+" "+T+" "+M),V=h(U);o.dom=e,o.keyframes=K,o.anim=N,o.pause=V,o.css=T%2===0?a[0]:k,o[W]=x(e,W,L,{callback:c,params:l}),o[Z]=x(e,Z,A,{callback:f,params:m}),o[q]=x(e,q,O,{callback:d,params:g,id:n}),y(e,N),$[n]=o}function I(e,n){var t=$[e];if(void 0===n&&(n=!1),K(t),N(t),M(t.dom,W,t[W].handler),M(t.dom,Z,t[Z].handler),M(t.dom,q,t[q].handler),n)U(t.dom,t.css),t[q].params.callback&&t[q].params.callback.apply(t.dom,t[q].params.params);else for(var a in t.css)t.dom.style[a]=F(t.dom,a);b(t.dom,t.anim),m(t.keyframes),m("."+t.anim),m("."+t.pause),k(t.dom,e),delete $[e]}function R(e,n){var t=n;for(var a in G)t===G[a]&&(t=s(t));return void 0!==e.style[t]?t:null}function C(e,n,t){var a=T(e,n,t);for(var r in J)if(n===J[r])return a;return"number"==typeof a?a+"px":a}function T(e,n,t){if("string"==typeof t){var a=t.substr(0,2),r=parseFloat(t.substr(2));switch(a){case"+=":t=parseFloat(F(e,n))+r;break;case"-=":t=parseFloat(F(e,n))-r}}return t}function L(e){e.callback&&e.callback.apply(this,e.params)}function A(e){e.callback&&e.callback.apply(this,e.params)}function O(e){I(e.id),e.callback&&e.callback.apply(this,e.params)}function x(e,n,t,a){var r=function(){t.apply(e,[a])};return e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent?e.attachEvent("on"+n,r):e["on"+n]=r,{handler:r,params:a}}function M(e,n,t){e.removeEventListener?e.removeEventListener(n,t):e.detachEvent?e.detachEvent("on"+n,t):delete e["on"+n]}function F(e,n){var t=e,a=R(e,n);if(null===a)throw"css name is wrong!!!";if(document.defaultView&&document.defaultView.getComputedStyle){var o=r(a),i=document.defaultView.getComputedStyle(t,"");return i&&i.getPropertyValue(o)}return t.currentStyle?t.currentStyle[a]:null}function U(e,n){var t=e;for(var a in n)t.style[a]=n[a]}function K(e){var n=e;y(n.dom,n.pause)}function N(e){var n=e;b(n.dom,n.pause)}var V=e.CT;n.VERSION="0.4.0",n.noConflict=function(){return e.CT=V,this};var Y,z,P,B="",W="animationstart",Z="animationiteration",q="animationend",Q=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE,j=window.CSSRule.STYLE_RULE||window.CSSRule.WEBKIT_STYLE_RULE||window.CSSRule.MOZ_STYLE_RULE,H=0,$={},D=0,G=["transform","transformOrigin","transformStyle","perspective","perspectiveOrigin","backfaceVisibility","transition"],J=["fontWeight","lineHeight","opacity","zoom"];return t(n,{get:function(e,n){if(arguments.length>2)throw"The number of parameters is too much!";var t=E(e);return F(t[0],n)},set:function(e,n){if(arguments.length>2)throw"The number of parameters is too much!";var t=E(e);a(t,function(e,t){var a={};for(var r in n){var o=R(t,r);o&&(a[o]=C(t,o,n[r]))}U(t,a)})},fromTo:function(){if(arguments.length<4)throw"The number of parameters is not enough!";var e=arguments,n=E(e[0]);a(n,function(n,t){var a=i(e);a[0]=t,S.apply(this,a)})},from:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var e=arguments,n=E(e[0]);a(n,function(n,t){var a=e[e.length-1],r={};for(var o in a){var u=R(t,o);r[o]=u?F(t,o):a[o]}var s=i(e);s[0]=t,s.push(r),S.apply(this,s)})},to:function(){if(arguments.length<3)throw"The number of parameters is not enough!";var e=arguments,n=E(e[0]);a(n,function(n,t){var a={},r=e[e.length-1];for(var o in r){var u=R(t,o);a[o]=u?F(t,o):r[o]}var s=i(e);s[0]=t,s.splice(2,0,a),S.apply(this,s)})},kill:function(e,n){var t=E(e);a(t,function(e,t){t._ct_tId&&I(t._ct_tId,n)})},killAll:function(e){for(var n in $)I(n,e)},pause:function(e){var n=E(e);a(n,function(e,n){n._ct_tId&&K($[n._ct_tId])})},pauseAll:function(){for(var e in $)K($[e])},resume:function(e){var n=E(e);a(n,function(e,n){n._ct_tId&&N($[n._ct_tId])})},resumeAll:function(){for(var e in $)N($[e])}}),t(n,{Linear:{easeIn:"(0, 0, 1, 1)",easeOut:"(0, 0, 1, 1)",easeInOut:"(0, 0, 1, 1)"},Sine:{easeIn:"(0.35, 0, 1, 1)",easeOut:"(0, 0, 0.65, 1)",easeInOut:"(0.35, 0, 0.65, 1)"},Quad:{easeIn:"(0.45, 0, 1, 1)",easeOut:"(0, 0, 0.55, 1)",easeInOut:"(0.45, 0, 0.55, 1)"},Quart:{easeIn:"(0.75, 0, 1, 1)",easeOut:"(0, 0, 0.25, 1)",easeInOut:"(0.75, 0, 0.25, 1)"},Expo:{easeIn:"(1, 0, 1, 1)",easeOut:"(0, 0, 0, 1)",easeInOut:"(1, 0, 0, 1)"}}),n});
